(()=>{"use strict";class t{constructor(t,e,s,i){this.name=t,this.attack=e,this.durability=s,this.initDurability=s,this.range=i}takeDamage(t){this.durability!==1/0&&(this.durability=Math.max(this.durability-t,0))}getDamage(){return 0===this.durability?0:this.durability>=.3*this.initDurability?this.attack:this.attack/2}isBroken(){return 0===this.durability}}class e extends t{constructor(){super("–†—É–∫–∞",1,1/0,1)}}class s extends t{constructor(){super("–ù–æ–∂",5,300,1)}}class i{constructor(t,s){this.life=100,this.magic=20,this.speed=1,this.attack=10,this.agility=5,this.luck=10,this.description="–ò–≥—Ä–æ–∫",this.weapon=new e,this.position=t,this.name=s}getLuck(){return Math.random()*(100+this.luck)/100}getDamage(t){return t>this.weapon.range?0:(this.attack+this.weapon.getDamage())*this.getLuck()/t}takeDamage(t){this.life=Math.max(this.life-t,0)}isDead(){return 0===this.life}moveLeft(t){this.position=Math.max(this.position-Math.min(t,this.speed),0)}moveRight(t){this.position+=Math.min(t,this.speed)}move(t){t<0?this.moveLeft(Math.abs(t)):this.moveRight(t)}isAttackBlocked(){return this.getLuck()>(100-this.luck)/100}dodged(){return this.getLuck()>(100-this.agility-3*this.speed)/100}takeAttack(t,e=null){null!==e&&(this.position=e),this.isAttackBlocked()?(this.weapon.takeDamage(t),console.log(`${this.name} –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –∞—Ç–∞–∫—É! –û—Ä—É–∂–∏–µ –ø–æ–ª—É—á–∏–ª–æ —É—Ä–æ–Ω ${t}`)):this.dodged()?console.log(`${this.name} —É–∫–ª–æ–Ω–∏–ª—Å—è –æ—Ç –∞—Ç–∞–∫–∏!`):(this.takeDamage(t),console.log(`${this.name} –ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω ${t}. –ó–¥–æ—Ä–æ–≤—å–µ: ${this.life}`)),this.checkWeapon()}checkWeapon(){this.weapon.isBroken()&&(console.log(`${this.name} –º–µ–Ω—è–µ—Ç —Å–ª–æ–º–∞–Ω–Ω–æ–µ –æ—Ä—É–∂–∏–µ.`),"Knife"===this.weapon.constructor.name?this.weapon=new e:this.weapon=new s)}tryAttack(t){const e=Math.abs(this.position-t.position);if(e>this.weapon.range){const e=`${this.name} –∞—Ç–∞–∫—É–µ—Ç ${t.name} –≤–ø–ª–æ—Ç–Ω—É—é!`,s=`${t.name} –æ—Ç–ª–µ—Ç–∞–µ—Ç –Ω–∞ 1 –∫–ª–µ—Ç–∫—É.`;return void console.log(`${e} ${s}`)}const s=10*this.getLuck();this.weapon.takeDamage(s);let i=this.getDamage(e);if(this.position===t.position){const e=t.position+1;console.log(`${this.name} –∞—Ç–∞–∫—É–µ—Ç ${t.name} –≤–ø–ª–æ—Ç–Ω—É—é!`),console.log(`${t.name} –æ—Ç–ª–µ—Ç–∞–µ—Ç –Ω–∞ 1 –∫–ª–µ—Ç–∫—É.`),i*=2,t.takeAttack(i,e)}else t.takeAttack(i)}chooseEnemy(t){let e=1/0,s=null;return t.forEach(t=>{t!==this&&!t.isDead()&&t.life<e&&(e=t.life,s=t)}),s}moveToEnemy(t){if(!t)return;const e=t.position-this.position;e<0?this.moveLeft(this.speed):e>0&&this.moveRight(this.speed)}turn(t){const e=this.chooseEnemy(t);e&&(console.log(`\n${this.name} (${this.description}) –¥–µ–ª–∞–µ—Ç —Ö–æ–¥:`),this.moveToEnemy(e),this.tryAttack(e))}}class n extends t{constructor(){super("–ú–µ—á",25,500,1)}}class o extends i{constructor(t,e){super(t,e),this.life=120,this.speed=2,this.attack=10,this.description="–í–æ–∏–Ω",this.weapon=new n}takeDamage(t){if(this.life<60&&this.getLuck()>.8&&this.magic>0){const e=Math.min(t,this.magic);this.magic-=e,console.log(`${this.name} –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª —É—Ä–æ–Ω –º–∞–≥–∏–µ–π! –û—Å—Ç–∞–ª–æ—Å—å –º–∞–Ω—ã: ${this.magic}`)}else this.life=Math.max(this.life-t,0)}checkWeapon(){this.weapon.isBroken()&&(console.log(`${this.name} –º–µ–Ω—è–µ—Ç —Å–ª–æ–º–∞–Ω–Ω–æ–µ –æ—Ä—É–∂–∏–µ.`),"Sword"===this.weapon.constructor.name?this.weapon=new s:"Knife"===this.weapon.constructor.name&&(this.weapon=new e))}}class a extends t{constructor(){super("–õ—É–∫",10,200,3)}}class h extends i{constructor(t,e){super(t,e),this.life=80,this.magic=35,this.attack=5,this.agility=10,this.description="–õ—É—á–Ω–∏–∫",this.weapon=new a}getDamage(t){return t>this.weapon.range?0:(this.attack+this.weapon.getDamage())*this.getLuck()*t/this.weapon.range}checkWeapon(){this.weapon.isBroken()&&(console.log(`${this.name} –º–µ–Ω—è–µ—Ç —Å–ª–æ–º–∞–Ω–Ω–æ–µ –æ—Ä—É–∂–∏–µ.`),"Bow"===this.weapon.constructor.name?this.weapon=new s:"Knife"===this.weapon.constructor.name&&(this.weapon=new e))}}class c extends t{constructor(){super("–ü–æ—Å–æ—Ö",8,300,2)}}class r extends i{constructor(t,e){super(t,e),this.life=70,this.magic=100,this.attack=5,this.agility=8,this.description="–ú–∞–≥",this.weapon=new c}takeDamage(t){let e=t;this.magic>50&&(this.magic-=12,e=t/2,console.log(`${this.name} –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞–≥–∏—é –¥–ª—è –∑–∞—â–∏—Ç—ã! –û—Å—Ç–∞–ª–æ—Å—å –º–∞–Ω—ã: ${this.magic}`)),this.life=Math.max(this.life-e,0)}checkWeapon(){this.weapon.isBroken()&&(console.log(`${this.name} –º–µ–Ω—è–µ—Ç —Å–ª–æ–º–∞–Ω–Ω–æ–µ –æ—Ä—É–∂–∏–µ.`),"Staff"===this.weapon.constructor.name?this.weapon=new s:"Knife"===this.weapon.constructor.name&&(this.weapon=new e))}}class l extends n{constructor(){super(),this.name="–°–µ–∫–∏—Ä–∞",this.attack=27,this.durability=800}}class p extends a{constructor(){super(),this.name="–î–ª–∏–Ω–Ω—ã–π –ª—É–∫",this.attack=15,this.range=4}}class m extends c{constructor(){super(),this.name="–ü–æ—Å–æ—Ö –ë—É—Ä–∏",this.attack=10,this.range=3}}const u=function(t){console.log("üéÆ –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —ç–ø–∏—á–µ—Å–∫–∞—è –±–∏—Ç–≤–∞!");let e=1;for(;t.filter(t=>!t.isDead()).length>1;)console.log(`\n=== –†–∞—É–Ω–¥ ${e} ===`),t.filter(t=>!t.isDead()).sort((t,e)=>e.speed-t.speed).forEach(e=>{e.turn(t.filter(t=>!t.isDead()))}),console.log("\n–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:"),t.forEach(t=>{const e=t.isDead()?"üíÄ –ú–ï–†–¢–í":`‚ù§Ô∏è ${t.life} HP, üîÆ ${t.magic} MP`;console.log(`${t.name} (${t.description}): ${e}, –ø–æ–∑–∏—Ü–∏—è: ${t.position}, –æ—Ä—É–∂–∏–µ: ${t.weapon.name} (${t.weapon.durability}/${t.weapon.initDurability})`)}),e+=1;const s=t.find(t=>!t.isDead());return console.log(`\nüèÜ –ü–û–ë–ï–î–ò–¢–ï–õ–¨: ${s.name} (${s.description})`),s}([new o(0,"–ê–ª—ë—à–∞ –ü–æ–ø–æ–≤–∏—á"),new h(5,"–õ–µ–≥–æ–ª–∞—Å"),new r(10,"–ì–µ–Ω–¥–∞–ª—å—Ñ"),new class extends o{constructor(t,e){super(t,e),this.life=130,this.attack=15,this.luck=20,this.description="–ì–Ω–æ–º",this.weapon=new l,this.hitCount=0}takeDamage(t){this.hitCount+=1;let e=t;this.hitCount%6==0&&this.getLuck()>.5&&(e=t/2,console.log(`${this.name} –ø–æ–ª—É—á–∏–ª –ø–æ–ª–æ–≤–∏–Ω–Ω—ã–π —É—Ä–æ–Ω –±–ª–∞–≥–æ–¥–∞—Ä—è —É–¥–∞—á–µ!`)),super.takeDamage(e)}checkWeapon(){this.weapon.isBroken()&&(console.log(`${this.name} –º–µ–Ω—è–µ—Ç —Å–ª–æ–º–∞–Ω–Ω–æ–µ –æ—Ä—É–∂–∏–µ.`),"Axe"===this.weapon.constructor.name?this.weapon=new s:"Knife"===this.weapon.constructor.name&&(this.weapon=new e))}}(3,"–ì–∏–º–ª–∏"),new class extends h{constructor(t,e){super(t,e),this.life=85,this.attack=8,this.agility=20,this.luck=15,this.description="–ê—Ä–±–∞–ª–µ—Ç—á–∏–∫",this.weapon=new p}checkWeapon(){this.weapon.isBroken()&&(console.log(`${this.name} –º–µ–Ω—è–µ—Ç —Å–ª–æ–º–∞–Ω–Ω–æ–µ –æ—Ä—É–∂–∏–µ.`),"LongBow"===this.weapon.constructor.name?this.weapon=new s:"Knife"===this.weapon.constructor.name&&(this.weapon=new e))}}(8,"–†–æ–±–∏–Ω –ì—É–¥"),new class extends r{constructor(t,e){super(t,e),this.life=80,this.magic=120,this.attack=6,this.luck=12,this.description="–î–µ–º–∏—É—Ä–≥",this.weapon=new m}getDamage(t){let e=super.getDamage(t);return this.magic>0&&this.getLuck()>.6&&(e*=1.5,this.magic-=10,console.log(`${this.name} –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞–≥–∏—é –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è –∞—Ç–∞–∫–∏! –û—Å—Ç–∞–ª–æ—Å—å –º–∞–Ω—ã: ${this.magic}`)),e}checkWeapon(){this.weapon.isBroken()&&(console.log(`${this.name} –º–µ–Ω—è–µ—Ç —Å–ª–æ–º–∞–Ω–Ω–æ–µ –æ—Ä—É–∂–∏–µ.`),"StormStaff"===this.weapon.constructor.name?this.weapon=new s:"Knife"===this.weapon.constructor.name&&(this.weapon=new e))}}(15,"–í–æ–ª–∞–Ω-–¥–µ-–ú–æ—Ä—Ç")]);console.log(`üèÅ –§–∏–Ω–∞–ª—å–Ω—ã–π –ø–æ–±–µ–¥–∏—Ç–µ–ª—å: ${u.name}`)})();